<h2>Ajout & modification de questions</h2>
<form [formGroup]="questionInfoForm">
    <div id="question-container">
        <label for="newQuestion">Question : </label><br />
        <input class="overflow-input" type="text" formControlName="text" name="newQuestion" id="newQuestion" placeholder="Question" required /><br />
        <p
            class="error"
            *ngIf="questionInfoForm.controls.text.invalid && (questionInfoForm.controls.text.dirty || questionInfoForm.controls.text.touched)"
        >
            La question entrée est déjà présente ou doit avoir au moins un caractère
        </p>
    </div>

    <div id="type-and-points">
        <div id="type-container">
            <label>Type de question : </label><br />
            <select for="question-type" id="question-type" formControlName="type" required>
                <option value="QCM">QCM</option>
            </select>
        </div>

        <div id="points-container">
            <label for="newPoints">Points : </label><br />
            <input
                type="number"
                [value]="defaultPoints"
                step="10"
                formControlName="points"
                name="newPoints"
                id="newPoints"
                min="10"
                max="100"
                [appRangeValidator]="{ min: 10, max: 100 }"
                placeholder="Points"
                (change)="questionInfoForm.controls.points.setValue(roundToNearest10())"
                required
            />
            <p class="error" *ngIf="questionInfoForm.controls.points.invalid">
                Les points attribués pour une bonne réponse doit être des multiples de 10 entre 10 et 100
            </p>
        </div>
    </div>

    <label id="add-choice-div">Choix : </label>
    <!-- <button type="button" (click)="addChoice()" class="btn btn-primary" [disabled]="choices.length >= maxChoices">Ajouter choix</button> -->
    <ol formArrayName="choices" id="choice-list">
        <li *ngFor="let choice of choices.controls; let i = index">
            <div class="choice" [formGroupName]="i">
                <div class="choice-def">
                    <input
                        class="overflow-input"
                        type="text"
                        formControlName="text"
                        minLength="1"
                        placeholder="Choix {{ i + 1 }}"
                        [required]="i < 2"
                    />
                    <mat-slide-toggle formControlName="isCorrect">Bonne réponse</mat-slide-toggle>
                </div>

                <div>
                    <button type="button" (click)="moveChoiceUp(i)" class="btn btn-secondary" [disabled]="i === 0">
                        <mat-icon [inline]="true">arrow_upward</mat-icon>
                    </button>
                    <button type="button" (click)="moveChoiceDown(i)" class="btn btn-secondary" [disabled]="i === choices.length - 1">
                        <mat-icon [inline]="true">arrow_downward</mat-icon>
                    </button>
                    <!-- <label class="switch">
                        <input type="checkbox" formControlName="isCorrect" />
                        <span class="slider round"></span>
                    </label> -->

                    <button type="button" (click)="removeChoice(i)" class="btn btn-danger">
                        <mat-icon [inline]="true">delete</mat-icon>
                    </button>
                </div>
            </div>
            <p
                class="error"
                *ngIf="
                    questionInfoForm.controls.choices.invalid &&
                    (questionInfoForm.controls.choices.dirty || questionInfoForm.controls.choices.touched)
                "
            >
                Il doit avoir au moins 2 choix et il doit y avoir au moins une bonne réponse et une mauvaise réponse
            </p>
        </li>
    </ol>
    <button id="questionValidation" (click)="openQuestionConfirmation()" [disabled]="questionInfoForm.invalid">Sauvegarder</button>
</form>
